<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">
<!--

-->
<beans default-autowire="byName">

    <!-- WARNING: as of 05/05/06, the context is empty when this file is being loaded.
        In particular, NO DATASOURCE!. You have been warned.
    -->

    <bean id="upgradeManager" class="com.zutubi.pulse.master.upgrade.DefaultUpgradeManager">
        <property name="upgradeableComponents">
            <list>
                <ref local="pulseUpgradeableComponent"/>
            </list>
        </property>
        <property name="upgradeableComponentSources">
            <list>
                <ref local="pluginUpgradeManager"/>
            </list>
        </property>
    </bean>

    <bean id="pluginUpgradeManager" class="com.zutubi.pulse.master.plugins.PluginUpgradeManager" init-method="init"/>

    <bean id="pulseUpgradeableComponent" class="com.zutubi.pulse.master.upgrade.tasks.PulseUpgradeableComponent">
        <property name="tasks">
            <list>
                <ref local="addBackupConfiguration"/>
                <ref local="addBrowseViewConfiguration"/>
                <ref local="updateDefaultAction"/>
                <ref local="addDefaultVersionToProjectResourceRequirements"/>
                <ref local="fixNPEOnLDAPRememberMe"/>
                <ref local="buildCompletedTriggerPropagateRevision"/>
                <ref local="addAllowPersonalBuilds"/>
                <ref local="ensureBackupConfigPermanent"/>
                <ref local="collapseRevisionRefactor"/>
                <ref local="projectLifecycle"/>
                <ref local="triggerRepackaging"/>
                <ref local="triggerState"/>
                <ref local="dashboardBuildPreferences"/>
                <ref local="featureDiscriminator"/>
                <ref local="addResourcePropertyDescription"/>
                <ref local="addPerforceTicketAuthentication"/>
                <ref local="deleteTempateProjectStates"/>
                <ref local="skippedTestCases"/>
                <ref local="ensureGlobalConfigPermanent"/>
                <ref local="dashboardShowUngrouped"/>
                <ref local="fixPermanentUsers"/>
                <ref local="revisionStringLimit"/>
            </list>
        </property>
        <property name="systemTasks">
            <list>
                <ref local="backup"/>
            </list>
        </property>
    </bean>

    <bean id="backup" class="com.zutubi.pulse.master.upgrade.tasks.BackupUpgradeTask"/>

    <bean id="addBackupConfiguration" class="com.zutubi.pulse.master.upgrade.tasks.AddBackupConfigurationToSettingsUpgradeTask">
        <property name="buildNumber" value="200007001"/>
    </bean>

    <bean id="addBrowseViewConfiguration" class="com.zutubi.pulse.master.upgrade.tasks.AddBrowseViewConfigurationUpgradeTask">
        <property name="buildNumber" value="200007002"/>
    </bean>

    <bean id="updateDefaultAction" class="com.zutubi.pulse.master.upgrade.tasks.UpdateDefaultActionUpgradeTask">
        <property name="buildNumber" value="200009001"/>
    </bean>

    <bean id="addDefaultVersionToProjectResourceRequirements" class="com.zutubi.pulse.master.upgrade.tasks.AddDefaultVersionToResourceRequirementUpgradeTask">
        <property name="buildNumber" value="200009002"/>
    </bean>

    <bean id="fixNPEOnLDAPRememberMe" class="com.zutubi.pulse.master.upgrade.tasks.FixNPEOnLDAPRememberMeUpgradeTask">
        <property name="buildNumber" value="200011001"/>
    </bean>

    <bean id="buildCompletedTriggerPropagateRevision" class="com.zutubi.pulse.master.upgrade.tasks.BuildCompletedTriggerPropagateRevisionUpgradeTask">
        <property name="buildNumber" value="200011002"/>
    </bean>

    <bean id="addAllowPersonalBuilds" class="com.zutubi.pulse.master.upgrade.tasks.AddAllowPersonalBuildsUpgradeTask">
        <property name="buildNumber" value="200011003"/>
    </bean>

    <bean id="ensureBackupConfigPermanent" class="com.zutubi.pulse.master.upgrade.tasks.EnsureBackupConfigPermanentUpgradeTask">
        <property name="buildNumber" value="200011004"/>
    </bean>

    <bean id="collapseRevisionRefactor" class="com.zutubi.pulse.master.upgrade.tasks.CollapseRevisionRefactorUpgradeTask">
        <property name="buildNumber" value="200013001"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/master/upgrade/tasks/schema/Schema-2.0.13-mappings.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="fixPersistentTriggerState" class="com.zutubi.pulse.master.upgrade.tasks.FixPersistentTriggerStateUpgradeTask">
        <property name="buildNumber" value="200013002"/>
    </bean>

    <bean id="projectLifecycle" class="com.zutubi.pulse.master.upgrade.tasks.ProjectLifecycleUpgradeTask">
        <property name="buildNumber" value="200013003"/>
    </bean>

    <bean id="triggerRepackaging" class="com.zutubi.pulse.master.upgrade.tasks.TriggerRepackagingUpgradeTask">
        <property name="buildNumber" value="200013004"/>
    </bean>

    <bean id="triggerState" class="com.zutubi.pulse.master.upgrade.tasks.TriggerStateUpgradeTask">
        <property name="buildNumber" value="200013005"/>
    </bean>

    <bean id="dashboardBuildPreferences" class="com.zutubi.pulse.master.upgrade.tasks.DashboardBuildPreferencesUpgradeTask">
        <property name="buildNumber" value="200014001"/>
    </bean>

    <bean id="featureDiscriminator" class="com.zutubi.pulse.master.upgrade.tasks.FeatureDiscriminatorUpgradeTask">
        <property name="buildNumber" value="200016001"/>
    </bean>

    <bean id="addResourcePropertyDescription" class="com.zutubi.pulse.master.upgrade.tasks.AddResourcePropertyDescriptionUpgradeTask">
        <property name="buildNumber" value="200018001"/>
    </bean>

    <bean id="addPerforceTicketAuthentication" class="com.zutubi.pulse.master.upgrade.tasks.AddPerforceTicketAuthenticationUpgradeTask">
        <property name="buildNumber" value="200018002"/>
    </bean>

    <bean id="deleteTempateProjectStates" class="com.zutubi.pulse.master.upgrade.tasks.DeleteTemplateProjectStateUpgradeTask">
        <property name="buildNumber" value="200019001"/>
    </bean>

    <bean id="skippedTestCases" class="com.zutubi.pulse.master.upgrade.tasks.MigrateSchemaUpgradeTask">
        <property name="buildNumber" value="200019002"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/master/upgrade/tasks/schema/Schema-2.0.19-patch-01.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="ensureGlobalConfigPermanent" class="com.zutubi.pulse.master.upgrade.tasks.EnsureGlobalConfigPermanentUpgradeTask">
        <property name="buildNumber" value="200021001"/>
    </bean>

    <bean id="dashboardShowUngrouped" class="com.zutubi.pulse.master.upgrade.tasks.DashboardShowUngroupedUpgradeTask">
        <property name="buildNumber" value="200022001"/>
    </bean>

    <bean id="fixPermanentUsers" class="com.zutubi.pulse.master.upgrade.tasks.FixPermanentUsersUpgradeTask">
        <property name="buildNumber" value="200023001"/>
    </bean>

    <bean id="revisionStringLimit" class="com.zutubi.pulse.master.upgrade.tasks.RevisionStringLimitUpgradeTask">
        <property name="buildNumber" value="200023002"/>
    </bean>
</beans>
