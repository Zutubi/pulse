<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">
<!--

-->
<beans>

    <!-- WARNING: as of 05/05/06, the context is empty when this file is being loaded.
        In particular, NO DATASOURCE!. You have been warned.
    -->

    <bean id="upgradeManager" class="com.zutubi.pulse.master.upgrade.DefaultUpgradeManager" autowire="byName">
        <property name="upgradeableComponents">
            <list>
                <ref local="pulseUpgradeableComponent"/>
            </list>
        </property>
        <property name="upgradeableComponentSources">
            <list>
                <ref local="pluginUpgradeManager"/>
            </list>
        </property>
    </bean>

    <bean id="pluginUpgradeManager" class="com.zutubi.pulse.master.plugins.PluginUpgradeManager" init-method="init" autowire="byName"/>

    <bean id="pulseUpgradeableComponent" class="com.zutubi.pulse.master.upgrade.tasks.PulseUpgradeableComponent" autowire="byName">
        <property name="tasks">
            <list>
                <ref local="addBackupConfiguration"/>
                <ref local="addBrowseViewConfiguration"/>
                <ref local="updateDefaultAction"/>
                <ref local="addDefaultVersionToProjectResourceRequirements"/>
                <ref local="fixNPEOnLDAPRememberMe"/>
                <ref local="buildCompletedTriggerPropagateRevision"/>
                <ref local="addAllowPersonalBuilds"/>
                <ref local="ensureBackupConfigPermanent"/>
                <ref local="collapseRevisionRefactor"/>
                <ref local="projectLifecycle"/>
                <ref local="triggerRepackaging"/>
                <ref local="triggerState"/>
                <ref local="dashboardBuildPreferences"/>
                <ref local="featureDiscriminator"/>
                <ref local="addResourcePropertyDescription"/>
            </list>
        </property>
        <property name="systemTasks">
            <list>
                <ref local="backup"/>
            </list>
        </property>
    </bean>

    <bean id="backup" class="com.zutubi.pulse.master.upgrade.tasks.BackupUpgradeTask" autowire="byName"/>

    <bean id="addBackupConfiguration" class="com.zutubi.pulse.master.upgrade.tasks.AddBackupConfigurationToSettingsUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200007001"/>
    </bean>

    <bean id="addBrowseViewConfiguration" class="com.zutubi.pulse.master.upgrade.tasks.AddBrowseViewConfigurationUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200007002"/>
    </bean>

    <bean id="updateDefaultAction" class="com.zutubi.pulse.master.upgrade.tasks.UpdateDefaultActionUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200009001"/>
    </bean>

    <bean id="addDefaultVersionToProjectResourceRequirements" class="com.zutubi.pulse.master.upgrade.tasks.AddDefaultVersionToResourceRequirementUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200009002"/>
    </bean>

    <bean id="fixNPEOnLDAPRememberMe" class="com.zutubi.pulse.master.upgrade.tasks.FixNPEOnLDAPRememberMeUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200011001"/>
    </bean>

    <bean id="buildCompletedTriggerPropagateRevision" class="com.zutubi.pulse.master.upgrade.tasks.BuildCompletedTriggerPropagateRevisionUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200011002"/>
    </bean>

    <bean id="addAllowPersonalBuilds" class="com.zutubi.pulse.master.upgrade.tasks.AddAllowPersonalBuildsUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200011003"/>
    </bean>

    <bean id="ensureBackupConfigPermanent" class="com.zutubi.pulse.master.upgrade.tasks.EnsureBackupConfigPermanentUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200011004"/>
    </bean>

    <bean id="collapseRevisionRefactor" class="com.zutubi.pulse.master.upgrade.tasks.CollapseRevisionRefactorUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200013001"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/master/upgrade/tasks/schema/Schema-2.0.13-mappings.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="fixPersistentTriggerState" class="com.zutubi.pulse.master.upgrade.tasks.FixPersistentTriggerStateUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200013002"/>
    </bean>

    <bean id="projectLifecycle" class="com.zutubi.pulse.master.upgrade.tasks.ProjectLifecycleUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200013003"/>
    </bean>

    <bean id="triggerRepackaging" class="com.zutubi.pulse.master.upgrade.tasks.TriggerRepackagingUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200013004"/>
    </bean>

    <bean id="triggerState" class="com.zutubi.pulse.master.upgrade.tasks.TriggerStateUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200013005"/>
    </bean>

    <bean id="dashboardBuildPreferences" class="com.zutubi.pulse.master.upgrade.tasks.DashboardBuildPreferencesUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200014001"/>
    </bean>

    <bean id="featureDiscriminator" class="com.zutubi.pulse.master.upgrade.tasks.FeatureDiscriminatorUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200016001"/>
    </bean>

    <bean id="addResourcePropertyDescription" class="com.zutubi.pulse.master.upgrade.tasks.AddResourcePropertyDescriptionUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200018001"/>
    </bean>

</beans>
