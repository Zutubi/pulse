<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">
<!--

-->
<beans default-autowire="byName">

    <bean id="upgradeManager" class="com.zutubi.pulse.master.upgrade.DefaultUpgradeManager">
        <property name="upgradeableComponents">
            <list>
                <ref local="pulseUpgradeableComponent"/>
            </list>
        </property>
        <property name="upgradeableComponentSources">
            <list>
                <ref local="pluginUpgradeManager"/>
            </list>
        </property>
    </bean>

    <bean id="pluginUpgradeManager" class="com.zutubi.pulse.master.plugins.PluginUpgradeManager" init-method="init"/>

    <bean id="pulseUpgradeableComponent" class="com.zutubi.pulse.master.upgrade.tasks.PulseUpgradeableComponent">
        <property name="tasks">
            <list>
                <ref local="addBackupConfiguration"/>
                <ref local="addBrowseViewConfiguration"/>
                <ref local="updateDefaultAction"/>
                <ref local="addDefaultVersionToProjectResourceRequirements"/>
                <ref local="fixNPEOnLDAPRememberMe"/>
                <ref local="buildCompletedTriggerPropagateRevision"/>
                <ref local="addAllowPersonalBuilds"/>
                <ref local="ensureBackupConfigPermanent"/>
                <ref local="collapseRevisionRefactor"/>
                <ref local="projectLifecycle"/>
                <ref local="triggerRepackaging"/>
                <ref local="triggerState"/>
                <ref local="dashboardBuildPreferences"/>
                <ref local="featureDiscriminator"/>
                <ref local="addResourcePropertyDescription"/>
                <ref local="addPerforceTicketAuthentication"/>
                <ref local="deleteTempateProjectStates"/>
                <ref local="skippedTestCases"/>
                <ref local="ensureGlobalConfigPermanent"/>
                <ref local="dashboardShowUngrouped"/>
                <ref local="fixPermanentUsers"/>
                <ref local="revisionStringLimit"/>
                <ref local="dashboardSortProperties"/>
                <ref local="buildResultNumberIndex"/>
                <ref local="userCollapsedProjects"/>
                <ref local="hookTriggerOptions"/>
                <ref local="buildResponsibility"/>
                <ref local="gitInactivityTimeout"/>
                <ref local="agentPriority"/>
                <ref local="gitTrackSelectedBranch"/>
                <ref local="autoClearResponsibility"/>
                <ref local="globalReports"/>
                <ref local="emailCommittersSinceSuccess"/>
                <ref local="scmCommitterMappings"/>
                <ref local="addIdLeader"/>
                <ref local="addPersistentWorkDir"/>
                <ref local="resourceRequirementOptional"/>
                <ref local="triggerProperties"/>
                <ref local="globalPostProcessors"/>
                <ref local="multiRecipeProjectType"/>
                <ref local="skeletonPostProcessors"/>
                <ref local="toveFile"/>
                <ref local="dependencies"/>
                <ref local="addStatusFieldToBuildResultTable"/>
                <ref local="addDependencyStatusField"/>
                <ref local="addBuildCompletedTriggerPropagateFields"/>
                <ref local="addCleanupStatusesField"/>
                <ref local="refactorCleanupWhatField"/>
                <ref local="deleteUnknownHiddenReferences"/>
                <ref local="addDependenciesVersionField"/>
                <ref local="addRepositoryConfiguration"/>
                <ref local="addDependentTriggerPropagateFields"/>
                <ref local="refactorDependencyPublicationUpgradeTask"/>
                <ref local="addSettingsFileToMaven2UpgradeTask"/>
                <ref local="dependencyTransitiveMode"/>
                <ref local="updateBuildResultAndAddSequenceTableUpgradeTask"/>
                <ref local="simpleTriggerSchema"/>
                <ref local="triggerConditions"/>
                <ref local="buildResultDependencyFields"/>
                <ref local="hostState"/>
                <ref local="agentEnableState"/>
                <ref local="addAgentDataDirectory"/>
                <ref local="updatePersistentWorkDir"/>
                <ref local="deleteOrphanedTriggers"/>
                <ref local="addPerforceSyncWorkspacePattern"/>
                <ref local="ldapGroupDns"/>
                <ref local="addAgentPing"/>
                <ref local="addJabberServiceName"/>
                <ref local="ensureAgentPingConfigPermanent"/>
                <ref local="expectedFailureTestCases"/>
                <ref local="addExpectedFailureReportSeries"/>
                <ref local="renameTriggerIntervalColumn"/>
                <ref local="ensureDependenciesAndOptionsConfigPermanent"/>
                <ref local="addPerforceView"/>
                <ref local="fixExpectedFailureSeries"/>
                <ref local="lastAccessTimes"/>
                <ref local="addPerforceTimeOffset"/>
                <ref local="dependentBuildTriggerUpdate"/>
            </list>
        </property>
        <property name="systemTasks">
            <list>
                <ref local="backup"/>
            </list>
        </property>
    </bean>

    <bean id="backup" class="com.zutubi.pulse.master.upgrade.tasks.BackupUpgradeTask"/>

    <bean id="addBackupConfiguration" class="com.zutubi.pulse.master.upgrade.tasks.AddBackupConfigurationToSettingsUpgradeTask">
        <property name="buildNumber" value="200007001"/>
    </bean>

    <bean id="addBrowseViewConfiguration" class="com.zutubi.pulse.master.upgrade.tasks.AddBrowseViewConfigurationUpgradeTask">
        <property name="buildNumber" value="200007002"/>
    </bean>

    <bean id="updateDefaultAction" class="com.zutubi.pulse.master.upgrade.tasks.UpdateDefaultActionUpgradeTask">
        <property name="buildNumber" value="200009001"/>
    </bean>

    <bean id="addDefaultVersionToProjectResourceRequirements" class="com.zutubi.pulse.master.upgrade.tasks.AddDefaultVersionToResourceRequirementUpgradeTask">
        <property name="buildNumber" value="200009002"/>
    </bean>

    <bean id="fixNPEOnLDAPRememberMe" class="com.zutubi.pulse.master.upgrade.tasks.FixNPEOnLDAPRememberMeUpgradeTask">
        <property name="buildNumber" value="200011001"/>
    </bean>

    <bean id="buildCompletedTriggerPropagateRevision" class="com.zutubi.pulse.master.upgrade.tasks.BuildCompletedTriggerPropagateRevisionUpgradeTask">
        <property name="buildNumber" value="200011002"/>
    </bean>

    <bean id="addAllowPersonalBuilds" class="com.zutubi.pulse.master.upgrade.tasks.AddAllowPersonalBuildsUpgradeTask">
        <property name="buildNumber" value="200011003"/>
    </bean>

    <bean id="ensureBackupConfigPermanent" class="com.zutubi.pulse.master.upgrade.tasks.EnsureBackupConfigPermanentUpgradeTask">
        <property name="buildNumber" value="200011004"/>
    </bean>

    <bean id="collapseRevisionRefactor" class="com.zutubi.pulse.master.upgrade.tasks.CollapseRevisionRefactorUpgradeTask">
        <property name="buildNumber" value="200013001"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/master/upgrade/tasks/schema/Schema-2.0.13-mappings.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="fixPersistentTriggerState" class="com.zutubi.pulse.master.upgrade.tasks.FixPersistentTriggerStateUpgradeTask">
        <property name="buildNumber" value="200013002"/>
    </bean>

    <bean id="projectLifecycle" class="com.zutubi.pulse.master.upgrade.tasks.ProjectLifecycleUpgradeTask">
        <property name="buildNumber" value="200013003"/>
    </bean>

    <bean id="triggerRepackaging" class="com.zutubi.pulse.master.upgrade.tasks.TriggerRepackagingUpgradeTask">
        <property name="buildNumber" value="200013004"/>
    </bean>

    <bean id="triggerState" class="com.zutubi.pulse.master.upgrade.tasks.TriggerStateUpgradeTask">
        <property name="buildNumber" value="200013005"/>
    </bean>

    <bean id="dashboardBuildPreferences" class="com.zutubi.pulse.master.upgrade.tasks.DashboardBuildPreferencesUpgradeTask">
        <property name="buildNumber" value="200014001"/>
    </bean>

    <bean id="featureDiscriminator" class="com.zutubi.pulse.master.upgrade.tasks.FeatureDiscriminatorUpgradeTask">
        <property name="buildNumber" value="200016001"/>
    </bean>

    <bean id="addResourcePropertyDescription" class="com.zutubi.pulse.master.upgrade.tasks.AddResourcePropertyDescriptionUpgradeTask">
        <property name="buildNumber" value="200018001"/>
    </bean>

    <bean id="addPerforceTicketAuthentication" class="com.zutubi.pulse.master.upgrade.tasks.AddPerforceTicketAuthenticationUpgradeTask">
        <property name="buildNumber" value="200018002"/>
    </bean>

    <bean id="deleteTempateProjectStates" class="com.zutubi.pulse.master.upgrade.tasks.DeleteTemplateProjectStateUpgradeTask">
        <property name="buildNumber" value="200019001"/>
    </bean>

    <bean id="skippedTestCases" class="com.zutubi.pulse.master.upgrade.tasks.MigrateSchemaUpgradeTask">
        <property name="buildNumber" value="200019002"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/master/upgrade/tasks/schema/Schema-2.0.19-patch-01.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="ensureGlobalConfigPermanent" class="com.zutubi.pulse.master.upgrade.tasks.EnsureGlobalConfigPermanentUpgradeTask">
        <property name="buildNumber" value="200021001"/>
    </bean>

    <bean id="dashboardShowUngrouped" class="com.zutubi.pulse.master.upgrade.tasks.DashboardShowUngroupedUpgradeTask">
        <property name="buildNumber" value="200022001"/>
    </bean>

    <bean id="fixPermanentUsers" class="com.zutubi.pulse.master.upgrade.tasks.FixPermanentUsersUpgradeTask">
        <property name="buildNumber" value="200023001"/>
    </bean>

    <bean id="revisionStringLimit" class="com.zutubi.pulse.master.upgrade.tasks.RevisionStringLimitUpgradeTask">
        <property name="buildNumber" value="200023002"/>
    </bean>

    <bean id="triggerProperties" class="com.zutubi.pulse.master.upgrade.tasks.TriggerPropertiesUpgradeTask">
        <property name="buildNumber" value="200025001"/>
    </bean>

    <bean id="dashboardSortProperties" class="com.zutubi.pulse.master.upgrade.tasks.AddDashboardSortPropertiesUpgradeTask">
        <property name="buildNumber" value="200027001"/>
    </bean>

    <bean id="buildResultNumberIndex" class="com.zutubi.pulse.master.upgrade.tasks.BuildResultNumberIndexUpgradeTask">
        <property name="buildNumber" value="200028001"/>
    </bean>

    <bean id="userCollapsedProjects" class="com.zutubi.pulse.master.upgrade.tasks.MigrateSchemaUpgradeTask">
        <property name="buildNumber" value="200028002"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/master/upgrade/tasks/schema/Schema-2.0.28-patch-01.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="hookTriggerOptions" class="com.zutubi.pulse.master.upgrade.tasks.HookTriggerOptionsUpgradeTask">
        <property name="buildNumber" value="200028003"/>
    </bean>

    <bean id="buildResponsibility" class="com.zutubi.pulse.master.upgrade.tasks.MigrateSchemaUpgradeTask">
        <property name="buildNumber" value="200029001"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/master/upgrade/tasks/schema/Schema-2.0.29-patch-01.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="gitInactivityTimeout" class="com.zutubi.pulse.master.upgrade.tasks.GitInactivityTimeoutUpgradeTask">
        <property name="buildNumber" value="200029002"/>
    </bean>

    <bean id="agentPriority" class="com.zutubi.pulse.master.upgrade.tasks.AgentPriorityUpgradeTask">
        <property name="buildNumber" value="200029003"/>
    </bean>

    <bean id="gitTrackSelectedBranch" class="com.zutubi.pulse.master.upgrade.tasks.GitTrackSelectedBranchUpgradeTask">
        <property name="buildNumber" value="200029004"/>
    </bean>

    <bean id="autoClearResponsibility" class="com.zutubi.pulse.master.upgrade.tasks.AutoClearResponsibilityUpgradeTask">
        <property name="buildNumber" value="200030001"/>
    </bean>

    <bean id="globalReports" class="com.zutubi.pulse.master.upgrade.tasks.GlobalReportsUpgradeTask">
        <property name="buildNumber" value="200031001"/>
    </bean>

    <bean id="emailCommittersSinceSuccess" class="com.zutubi.pulse.master.upgrade.tasks.EmailCommittersSinceSuccessUpgradeTask">
        <property name="buildNumber" value="200032001"/>
    </bean>

    <bean id="scmCommitterMappings" class="com.zutubi.pulse.master.upgrade.tasks.ScmCommitterMappingsUpgradeTask">
        <property name="buildNumber" value="200032002"/>
    </bean>

    <bean id="addIdLeader" class="com.zutubi.pulse.master.upgrade.tasks.AddIdLeaderUpgradeTask">
        <property name="buildNumber" value="200033001"/>
    </bean>

    <bean id="addPersistentWorkDir" class="com.zutubi.pulse.master.upgrade.tasks.AddPersistentWorkDirUpgradeTask">
        <property name="buildNumber" value="200036001"/>
    </bean>

    <bean id="resourceRequirementOptional" class="com.zutubi.pulse.master.upgrade.tasks.ResourceRequirementOptionalUpgradeTask">
        <property name="buildNumber" value="200999001"/>
    </bean>

    <bean id="globalPostProcessors" class="com.zutubi.pulse.master.upgrade.tasks.GlobalPostProcessorsUpgradeTask">
        <property name="buildNumber" value="200999002"/>
    </bean>

    <bean id="multiRecipeProjectType" class="com.zutubi.pulse.master.upgrade.tasks.MultiRecipeProjectTypeUpgradeTask">
        <property name="buildNumber" value="200999003"/>
    </bean>

    <bean id="skeletonPostProcessors" class="com.zutubi.pulse.master.upgrade.tasks.SkeletonPostProcessorsUpgradeTask">
        <property name="buildNumber" value="200999004"/>
    </bean>

    <bean id="toveFile" class="com.zutubi.pulse.master.upgrade.tasks.ToveFileUpgradeTask">
        <property name="buildNumber" value="200999005"/>
    </bean>

    <bean id="dependencies" class="com.zutubi.pulse.master.upgrade.tasks.DependenciesUpgradeTask">
        <property name="buildNumber" value="200999006"/>
    </bean>

    <bean id="addStatusFieldToBuildResultTable" class="com.zutubi.pulse.master.upgrade.tasks.MigrateSchemaUpgradeTask">
        <property name="buildNumber" value="201003001"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/master/upgrade/tasks/schema/Schema-2.0.99-patch-01.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="addDependencyStatusField" class="com.zutubi.pulse.master.upgrade.tasks.AddDependencyStatusFieldUpgradeTask">
        <property name="buildNumber" value="201003002"/>
    </bean>

    <bean id="addBuildCompletedTriggerPropagateFields" class="com.zutubi.pulse.master.upgrade.tasks.AddBuildCompletedTriggerPropagateFieldsUpgradeTask">
        <property name="buildNumber" value="201003003"/>
    </bean>

    <bean id="addCleanupStatusesField" class="com.zutubi.pulse.master.upgrade.tasks.AddCleanupStatusesFieldUpgradeTask">
        <property name="buildNumber" value="201003004"/>
    </bean>

    <bean id="refactorCleanupWhatField" class="com.zutubi.pulse.master.upgrade.tasks.RefactorCleanupWhatFieldUpgradeTask">
        <property name="buildNumber" value="201003005"/>
    </bean>

    <bean id="addDependenciesVersionField" class="com.zutubi.pulse.master.upgrade.tasks.AddDependencyVersionFieldUpgradeTask">
        <property name="buildNumber" value="201003006"/>
    </bean>
    <bean id="addRepositoryConfiguration" class="com.zutubi.pulse.master.upgrade.tasks.AddRepositoryConfigurationToSettingsUpgradeTask">
        <property name="buildNumber" value="201003007"/>
    </bean>

    <bean id="addDependentTriggerPropagateFields" class="com.zutubi.pulse.master.upgrade.tasks.AddDependentTriggerPropagateFieldsUpgradeTask">
        <property name="buildNumber" value="201003008"/>
    </bean>

    <bean id="refactorDependencyPublicationUpgradeTask" class="com.zutubi.pulse.master.upgrade.tasks.RefactorDependencyPublicationUpgradeTask">
        <property name="buildNumber" value="201003009"/>
    </bean>

    <bean id="addSettingsFileToMaven2UpgradeTask" class="com.zutubi.pulse.master.upgrade.tasks.AddSettingsFileArgumentToMaven2ConfigurationUpgradeTask">
        <property name="buildNumber" value="201003010"/>
    </bean>

    <bean id="dependencyTransitiveMode" class="com.zutubi.pulse.master.upgrade.tasks.AddDependencyTransitiveModeUpgradeTask">
        <property name="buildNumber" value="201004001"/>
    </bean>

    <bean id="updateBuildResultAndAddSequenceTableUpgradeTask" class="com.zutubi.pulse.master.upgrade.tasks.MigrateSchemaUpgradeTask">
        <property name="buildNumber" value="201004002"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/master/upgrade/tasks/schema/Schema-2.1.5-patch-01.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="simpleTriggerSchema" class="com.zutubi.pulse.master.upgrade.tasks.RemoveTriggerDataMapRefactorUpgradeTask">
        <property name="buildNumber" value="201004003"/>
    </bean>

    <bean id="triggerConditions" class="com.zutubi.pulse.master.upgrade.tasks.TriggerConditionsUpgradeTask">
        <property name="buildNumber" value="201004004"/>
    </bean>

    <bean id="buildResultDependencyFields" class="com.zutubi.pulse.master.upgrade.tasks.BuildResultDependencyFieldsUpgradeTask">
        <property name="buildNumber" value="201005001"/>
    </bean>

    <bean id="hostState" class="com.zutubi.pulse.master.upgrade.tasks.MigrateSchemaUpgradeTask">
        <property name="buildNumber" value="201006001"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/master/upgrade/tasks/schema/Schema-2.1.6-patch-01.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="agentEnableState" class="com.zutubi.pulse.master.upgrade.tasks.AgentEnableStateUpgradeTask">
        <property name="buildNumber" value="201006002"/>
    </bean>

    <bean id="addAgentDataDirectory" class="com.zutubi.pulse.master.upgrade.tasks.AddAgentDataDirectoryUpgradeTask">
        <property name="buildNumber" value="201006003"/>
    </bean>

    <bean id="updatePersistentWorkDir" class="com.zutubi.pulse.master.upgrade.tasks.UpdatePersistentWorkDirUpgradeTask">
        <property name="buildNumber" value="201006004"/>
    </bean>

    <bean id="deleteOrphanedTriggers" class="com.zutubi.pulse.master.upgrade.tasks.DeleteOrphanedTriggersUpgradeTask">
        <property name="buildNumber" value="201007001"/>
    </bean>

    <bean id="addPerforceSyncWorkspacePattern" class="com.zutubi.pulse.master.upgrade.tasks.AddPerforceSyncWorkspacePatternUpgradeTask">
        <property name="buildNumber" value="201007002"/>
    </bean>

    <bean id="ldapGroupDns" class="com.zutubi.pulse.master.upgrade.tasks.LdapGroupDnsUpgradeTask">
        <property name="buildNumber" value="201008001"/>
    </bean>

    <bean id="addAgentPing" class="com.zutubi.pulse.master.upgrade.tasks.AddAgentPingConfigurationUpgradeTask">
        <property name="buildNumber" value="201008002"/>
    </bean>

    <bean id="addJabberServiceName" class="com.zutubi.pulse.master.upgrade.tasks.AddJabberServiceNameUpgradeTask">
        <property name="buildNumber" value="201008003"/>
    </bean>

    <bean id="ensureAgentPingConfigPermanent" class="com.zutubi.pulse.master.upgrade.tasks.EnsureAgentPingConfigPermanentUpgradeTask">
        <property name="buildNumber" value="201008004"/>
    </bean>

    <bean id="expectedFailureTestCases" class="com.zutubi.pulse.master.upgrade.tasks.MigrateSchemaUpgradeTask">
        <property name="buildNumber" value="201008005"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/master/upgrade/tasks/schema/Schema-2.1.8-patch-01.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="addExpectedFailureReportSeries" class="com.zutubi.pulse.master.upgrade.tasks.AddExpectedFailureReportSeriesUpgradeTask">
        <property name="buildNumber" value="201008006"/>
    </bean>

    <bean id="deleteUnknownHiddenReferences" class="com.zutubi.pulse.master.upgrade.tasks.DeleteUnknownHiddenReferencesUpgradeTask">
        <property name="buildNumber" value="201008007"/>
    </bean>

    <bean id="renameTriggerIntervalColumn"
          class="com.zutubi.pulse.master.upgrade.tasks.RenameTriggerIntervalColumnUpgradeTask">
        <property name="buildNumber" value="201008008"/>
        <property name="mappings">
            <list>
                <!-- for this refactor we need to know what affected portion of the schema looked like before the refactor -->
                <value>com/zutubi/pulse/master/upgrade/tasks/schema/Schema-2.1.8-partial-mappings.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="ensureDependenciesAndOptionsConfigPermanent" class="com.zutubi.pulse.master.upgrade.tasks.EnsureDependenciesAndOptionsConfigPermanentUpgradeTask">
        <property name="buildNumber" value="201008009"/>
    </bean>

    <bean id="addPerforceView" class="com.zutubi.pulse.master.upgrade.tasks.AddPerforceViewUpgradeTask">
        <property name="buildNumber" value="201008010"/>
    </bean>

    <bean id="fixExpectedFailureSeries" class="com.zutubi.pulse.master.upgrade.tasks.FixExpectedFailureSeriesUpgradeTask">
        <property name="buildNumber" value="201009001"/>
    </bean>

    <bean id="lastAccessTimes" class="com.zutubi.pulse.master.upgrade.tasks.MigrateSchemaUpgradeTask">
        <property name="buildNumber" value="201010001"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/master/upgrade/tasks/schema/Schema-2.1.10-patch-01.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="addPerforceTimeOffset" class="com.zutubi.pulse.master.upgrade.tasks.AddPerforceTimeOffsetUpgradeTask">
        <property name="buildNumber" value="201010002"/>
    </bean>

    <bean id="dependentBuildTriggerUpdate" class="com.zutubi.pulse.master.upgrade.tasks.DependentBuildTriggerUpgradeTask">
        <property name="buildNumber" value="201010003"/>
    </bean>

</beans>
