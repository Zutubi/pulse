#helpTag("Project+Dependencies+Tab")
#authorisationTags($principle)
#projectTags($project)
<content tag="header.javascript">
    zutubi/pulse/project/browse/ProjectDependenciesPanel.js
    projects.js
</content>
<html>
<head>
    <title>$!webwork.htmlEncode($project.name)</title>
    <script type="text/javascript">
        #if($refreshInterval)
        var refreshInterval = $refreshInterval;
        #elseif($principle.preferences.refreshingEnabled)
        var refreshInterval = $principle.preferences.refreshInterval;
        #else
        var refreshInterval = 0;
        #end
        var view;
        var panel = null;
        
        function update(data)
        {
            if (panel)
            {
                panel.update(data);
            }
            else
            {
                panel = new Zutubi.pulse.project.browse.ProjectDependenciesPanel({
                    loadingEl: '#id("project-dependencies-$project.name")',
                    projectId: '$project.id',
                    data: data
                });

                Ext.get('center').setStyle({margin: '0', padding: '0'});
                var nestedCenter = Ext.getCmp('nested-center');
                nestedCenter.add(panel);
                viewport.doLayout();
            }
        }

        function refresh(cb)
        {
            view.load(cb);
        }
        
        Ext.onReady(function() {
            view = new Zutubi.ActiveView(window.baseUrl + '/ajax/projectDependenciesData.action?projectId=$project.id', refreshInterval, update, window, Ext.get('#id("project-dependencies-$project.name")'), 'Unable to load project dependencies.');
            view.init();
        });
    </script>
</head>
<body>
    #projectTabs("dependencies")

    #parse("/template/includes/actionerrors.vm")

    <div id='#id("project-dependencies-$project.name")'>
    </div>
</body>
</html>
