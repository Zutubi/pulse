<?xml version="1.0" encoding="UTF-8"?>
<project xmlns:ivy="antlib:fr.jayasoft.ivy.ant">
    <import file="../common-build.xml"/>

    <!-- Bundles require special packaging -->
    <target name="common-package">
        <echo message="----------------------------------------------"/>
        <echo message="    Component: package ${ivy.module}              "/>
        <echo message="----------------------------------------------"/>

        <jar file="build/${ivy.module}.jar" manifest="resources/META-INF/MANIFEST.MF">
            <fileset dir="${classes.dir}"/>
            <fileset dir="resources" excludes="resources/META-INF/MANIFEST.MF"/>
            <path refid="src.export.selection"/>
        </jar>

        <package-src name="${ivy.module}-src.jar" pathref="src.export.selection"/>

        <if>
            <not><isset property="no.tests"/></not>
            <then>
                <jar file="build/${ivy.module}-test.jar">
                    <fileset dir="${test.classes.dir}"/>
                    <path refid="test.export.selection"/>
                </jar>
    
                <package-src name="${ivy.module}-test-src.jar" pathref="test.export.selection"/>
            </then>
        </if>
    </target>
</project>
