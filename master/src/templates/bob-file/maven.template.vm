<?xml version="1.0"?>
<project defaultRecipe="maven build">

    <post-processor name="maven.pp">
        <regex>
            <!-- maven returns a 0 exit code regardless of the state of the build.. -->
            <pattern category="error" expression=".*BUILD FAILED.*"/>
            <pattern category="error" expression="Basedir.*does not exist"/>
            <!-- notify about any exceptions in the logs. -->
            <pattern category="warning" expression=".*Exception.*"/>
        </regex>
    </post-processor>

    <recipe name="maven build">
        <command name="build">
            <executable exe="maven.bat" working-dir="${base.dir}">
#if($baseDir)
                <arg>-d</arg>
                <arg>$!baseDir</arg>
#end
#foreach($target in $targets)
                <arg>$target</arg>
#end
                <process processor="${maven.pp}"/>
            </executable>
        </command>
    </recipe>
</project>
