<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">
<!--

-->
<beans>

    <!-- WARNING: as of 05/05/06, the context is empty when this file is being loaded.
        In particular, NO DATASOURCE!. You have been warned.
    -->

    <bean id="upgradeManager" class="com.zutubi.pulse.upgrade.DefaultUpgradeManager" autowire="byName">
        <property name="tasks">
            <list>
                <ref local="scmUidTask"/>
                <ref local="userPropsSchemaUpgrade"/>
                <ref local="userPropsDataUpgrade"/>
                <ref local="encryptPasswordUpgrade"/>
                <ref local="artifactsSchemaUpgrade"/>
                <ref local="mavenCapturesUpgrade"/>
                <ref local="flexibleConditionUpgrade"/>
                <ref local="scmMonitorSchemaUpgrade"/>
                <ref local="scmMonitorDataUpgrade"/>
                <ref local="dropBuildChangelistsUpgrade"/>
                <ref local="repairUniqueKeyUpgradeUpgrade"/>
                <ref local="distributedSchemaUpgrade"/>
                <ref local="distributedDataUpgrade"/>
                <ref local="resourceEnvironment"/>
                <ref local="schemaUpgrade0101001"/>
                <ref local="adminUser"/>
                <ref local="buildNumber"/>
                <ref local="relativePath"/>
                <ref local="retainWorkingCopy"/>
                <ref local="triggerForce"/>
                <ref local="schemaUpgrade0101002"/>
                <ref local="dashboardProjects"/>
                <ref local="incrementalBuild"/>
                <ref local="renameHostNameToBaseUrl"/>
                <ref local="estimatedRunningTime"/>
                <ref local="schemaUpgrade0101006001"/>
                <ref local="subscriptionProjects"/>
                <ref local="schemaUpgrade0101006003"/>
                <ref local="groups"/>
                <ref local="schemaUpgrade0101007001"/>
                <ref local="orphanedTriggers"/>
                <ref local="schemaUpgrade0101011001"/>
                <ref local="testStorage"/>
                <ref local="schemaUpgrade0101999001"/>
                <ref local="slaveEnabledState"/>
            </list>
        </property>
    </bean>

    <bean id="scmUidTask" class="com.zutubi.pulse.upgrade.tasks.MigrateSchemaUpgradeTask" autowire="byName">
        <property name="buildNumber" value="1001"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/upgrade/schema/build_1001/Changelist.hbm.xml</value>
                <value>com/zutubi/pulse/upgrade/schema/build_1001/Revision.hbm.xml</value>
            </list>
        </property>
    </bean>

    <!-- Introduce the new User properties table and migrate the data. -->
    <bean id="userPropsSchemaUpgrade" class="com.zutubi.pulse.upgrade.tasks.UserPropsSchemaUpgradeTask" autowire="byName">
        <property name="buildNumber" value="1011"/>
    </bean>

    <bean id="userPropsDataUpgrade" class="com.zutubi.pulse.upgrade.tasks.UserPropsDataUpgradeTask" autowire="byName">
        <property name="buildNumber" value="1011"/>
    </bean>

    <!-- Encrypt the users passwords in the user table. -->
    <bean id="encryptPasswordUpgrade" class="com.zutubi.pulse.upgrade.tasks.EncodePasswordUpgradeTask" autowire="byName">
        <property name="buildNumber" value="1021"/>
    </bean>

    <bean id="artifactsSchemaUpgrade" class="com.zutubi.pulse.upgrade.tasks.MigrateSchemaUpgradeTask" autowire="byName">
        <property name="buildNumber" value="1021"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/upgrade/schema/build_1021/Project.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="mavenCapturesUpgrade" class="com.zutubi.pulse.upgrade.tasks.MavenCapturesUpgradeTask" autowire="byName">
        <property name="buildNumber" value="1022"/>
    </bean>

    <bean id="flexibleConditionUpgrade" class="com.zutubi.pulse.upgrade.tasks.FlexibleConditionUpgradeTask" autowire="byName">
        <property name="buildNumber" value="1031"/>
    </bean>

    <bean id="clonedProjectDataPatchUpgrade" class="com.zutubi.pulse.upgrade.tasks.ClonedProjectDataPatchUpgradeTask" autowire="byName">
        <property name="buildNumber" value="1041"/>
    </bean>

    <bean id="scmMonitorSchemaUpgrade" class="com.zutubi.pulse.upgrade.tasks.ScmMonitorSchemaUpgradeTask" autowire="byName">
        <property name="buildNumber" value="1042"/>
    </bean>

    <bean id="scmMonitorDataUpgrade" class="com.zutubi.pulse.upgrade.tasks.ScmMonitorDataUpgradeTask" autowire="byName">
        <property name="buildNumber" value="1042"/>
    </bean>

    <bean id="dropBuildChangelistsUpgrade" class="com.zutubi.pulse.upgrade.tasks.DropBuildChangelistsUpgradeTask" autowire="byName">
        <property name="buildNumber" value="1051"/>
    </bean>

    <bean id="repairUniqueKeyUpgradeUpgrade" class="com.zutubi.pulse.upgrade.tasks.RepairUniqueKeyUpgradeTask" autowire="byName">
        <property name="buildNumber" value="1051"/>
    </bean>

    <bean id="distributedSchemaUpgrade" class="com.zutubi.pulse.upgrade.tasks.MigrateSchemaUpgradeTask" autowire="byName">
        <property name="buildNumber" value="100999001"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/upgrade/schema/build_0100999001/BuildResult.hbm.xml</value>
                <value>com/zutubi/pulse/upgrade/schema/build_0100999001/BuildSpecification.hbm.xml</value>
                <value>com/zutubi/pulse/upgrade/schema/build_0100999001/CommitMessageTransformer.hbm.xml</value>
                <value>com/zutubi/pulse/upgrade/schema/build_0100999001/Project.hbm.xml</value>
                <value>com/zutubi/pulse/upgrade/schema/build_0100999001/Resource.hbm.xml</value>
                <value>com/zutubi/pulse/upgrade/schema/build_0100999001/Slave.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="distributedDataUpgrade" class="com.zutubi.pulse.upgrade.tasks.DistributedUpgradeTask" autowire="byName">
        <property name="buildNumber" value="100999002"/>
    </bean>

    <bean id="resourceEnvironment" class="com.zutubi.pulse.upgrade.tasks.ResourceEnvironmentUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101000001"/>
    </bean>

    <bean id="schemaUpgrade0101001" class="com.zutubi.pulse.upgrade.tasks.MigrateSchemaUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101000002"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/upgrade/schema/build_0101000001/BuildSpecification.hbm.xml</value>
                <value>com/zutubi/pulse/upgrade/schema/build_0101000001/Project.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="adminUser" class="com.zutubi.pulse.upgrade.tasks.AdminUserUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101000003"/>
    </bean>

    <bean id="buildNumber" class="com.zutubi.pulse.upgrade.tasks.BuildNumberUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101000004"/>
    </bean>

    <bean id="relativePath" class="com.zutubi.pulse.upgrade.tasks.RelativePathUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101000005"/>
    </bean>

    <bean id="retainWorkingCopy" class="com.zutubi.pulse.upgrade.tasks.RetainWorkingCopyUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101000006"/>
    </bean>

    <bean id="triggerForce" class="com.zutubi.pulse.upgrade.tasks.TriggerForceUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101000007"/>
    </bean>

    <bean id="schemaUpgrade0101002" class="com.zutubi.pulse.upgrade.tasks.MigrateSchemaUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101001001"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/upgrade/schema/build_0101001001/BuildSpecification.hbm.xml</value>
                <value>com/zutubi/pulse/upgrade/schema/build_0101001001/Project.hbm.xml</value>
                <value>com/zutubi/pulse/upgrade/schema/build_0101001001/User.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="dashboardProjects" class="com.zutubi.pulse.upgrade.tasks.DashboardProjectsUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101001002"/>
    </bean>

    <bean id="incrementalBuild" class="com.zutubi.pulse.upgrade.tasks.IncrementalBuildUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101001003"/>
    </bean>

    <bean id="renameHostNameToBaseUrl" class="com.zutubi.pulse.upgrade.tasks.RenameHostNamePropertyUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101002004"/>
    </bean>

    <bean id="estimatedRunningTime" class="com.zutubi.pulse.upgrade.tasks.EstimatedRunningTimeUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101004001"/>
    </bean>

    <bean id="schemaUpgrade0101006001" class="com.zutubi.pulse.upgrade.tasks.MigrateSchemaUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101006001"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/upgrade/schema/build_0101006001/Project.hbm.xml</value>
                <value>com/zutubi/pulse/upgrade/schema/build_0101006001/User.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="subscriptionProjects" class="com.zutubi.pulse.upgrade.tasks.SubscriptionProjectsUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101006002"/>
    </bean>

    <bean id="schemaUpgrade0101006003" class="com.zutubi.pulse.upgrade.tasks.MigrateSchemaUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101006003"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/upgrade/schema/build_0101006003/Group.hbm.xml</value>
                <value>com/zutubi/pulse/upgrade/schema/build_0101006003/User.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="groups" class="com.zutubi.pulse.upgrade.tasks.GroupsUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101006004"/>
    </bean>

    <bean id="schemaUpgrade0101007001" class="com.zutubi.pulse.upgrade.tasks.MigrateSchemaUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101007001"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/upgrade/schema/build_0101007001/User.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="orphanedTriggers" class="com.zutubi.pulse.upgrade.tasks.OrphanedTriggerUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101008001"/>
    </bean>

    <bean id="schemaUpgrade0101011001" class="com.zutubi.pulse.upgrade.tasks.MigrateSchemaUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101011001"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/upgrade/schema/build_0101011001/BuildResult.hbm.xml</value>
                <value>com/zutubi/pulse/upgrade/schema/build_0101011001/Scm.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="testStorage" class="com.zutubi.pulse.upgrade.tasks.TestStorageUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101011002"/>
    </bean>

    <bean id="schemaUpgrade0101999001" class="com.zutubi.pulse.upgrade.tasks.MigrateSchemaUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101999001"/>
        <property name="mappings">
            <list>
                <value>com/zutubi/pulse/upgrade/schema/build_0101999001/BuildResult.hbm.xml</value>
                <value>com/zutubi/pulse/upgrade/schema/build_0101999001/Slave.hbm.xml</value>
                <value>com/zutubi/pulse/upgrade/schema/build_0101999001/User.hbm.xml</value>
            </list>
        </property>
    </bean>

    <bean id="slaveEnabledState" class="com.zutubi.pulse.upgrade.tasks.SlaveEnabledStateUpgradeTask" autowire="byName">
        <property name="buildNumber" value="101999002"/>
    </bean>
</beans>
