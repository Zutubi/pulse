<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">
<!--

-->
<beans>

    <!-- WARNING: as of 05/05/06, the context is empty when this file is being loaded.
        In particular, NO DATASOURCE!. You have been warned.
    -->

    <bean id="upgradeManager" class="com.zutubi.pulse.upgrade.DefaultUpgradeManager" autowire="byName">
        <property name="upgradeableComponents">
            <list>
                <ref local="pulseUpgradeableComponent"/>
            </list>
        </property>
        <property name="upgradeableComponentSources">
            <list>
                <ref local="pluginUpgradeManager"/>
            </list>
        </property>
    </bean>

    <bean id="pluginUpgradeManager" class="com.zutubi.pulse.plugins.PluginUpgradeManager" init-method="init" autowire="byName"/>

    <bean id="pulseUpgradeableComponent" class="com.zutubi.pulse.upgrade.tasks.PulseUpgradeableComponent" autowire="byName">
        <property name="tasks">
            <list>
                <ref local="addBackupConfiguration"/>
                <ref local="addBrowseViewConfiguration"/>
                <ref local="updateDefaultAction"/>
                <ref local="addDefaultVersionToProjectResourceRequirements"/>
                <ref local="fixNPEOnLDAPRememberMe"/>
                <ref local="buildCompletedTriggerPropagateRevision"/>
                <ref local="addAllowPersonalBuilds"/>
            </list>
        </property>
        <property name="systemTasks">
            <list>
                <ref local="backup"/>
            </list>
        </property>
    </bean>

    <bean id="backup" class="com.zutubi.pulse.upgrade.tasks.BackupUpgradeTask" autowire="byName"/>

    <bean id="addBackupConfiguration" class="com.zutubi.pulse.upgrade.tasks.AddBackupConfigurationToSettingsUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200007001"/>
    </bean>

    <bean id="addBrowseViewConfiguration" class="com.zutubi.pulse.upgrade.tasks.AddBrowseViewConfigurationUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200007002"/>
    </bean>

    <bean id="updateDefaultAction" class="com.zutubi.pulse.upgrade.tasks.UpdateDefaultActionUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200009001"/>
    </bean>

    <bean id="addDefaultVersionToProjectResourceRequirements" class="com.zutubi.pulse.upgrade.tasks.AddDefaultVersionToResourceRequirementUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200009002"/>
    </bean>

    <bean id="fixNPEOnLDAPRememberMe" class="com.zutubi.pulse.upgrade.tasks.FixNPEOnLDAPRememberMeUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200011001"/>
    </bean>

    <bean id="buildCompletedTriggerPropagateRevision" class="com.zutubi.pulse.upgrade.tasks.BuildCompletedTriggerPropagateRevisionUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200011002"/>
    </bean>

    <bean id="addAllowPersonalBuilds" class="com.zutubi.pulse.upgrade.tasks.AddAllowPersonalBuildsUpgradeTask" autowire="byName">
        <property name="buildNumber" value="200011003"/>
    </bean>
</beans>
