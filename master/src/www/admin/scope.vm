#authorisationTags($principle)
<content tag="selectedTab">$section</content>
<html>
<head>
    <title>#wwtext("name=${section}")</title>
	<script type="text/javascript">
	    var actionInProgress = false;
        var configTree;
        var treesInitialised = false;

        var handleConfigurationResponse = function(result)
        {
            if(result.success)
            {
                if(result.newPanel)
                {
                    Ext.get('detail-pane').update(result.newPanel, true);
                }
                configTree.handleResponse(result);
                configTree.redirectToNewPath(result);
            }
            else
            {
                if(result.actionErrors && result.actionErrors.length > 0)
                {
                    showStatus(result.actionErrors[0], 'failure');
                }
            }
        }

        var Layout = function()
        {
            var centerRegion;
#if($path)
            var path = '$path';
#else
            var path = '';
#end

            return {
                init : function()
                {
                    var centerEl = Ext.get('center');
                    centerEl.setStyle('margin', '4px');

                    var loader = new ZUTUBI.ConfigTreeLoader('$base/aconfig');

                    configTree = new ZUTUBI.ConfigTree({
#if($prefixPath)
                        pathPrefix: '$prefixPath',
#end
                        el: 'config-tree',
                        layout: 'fit',
                        border: false,
                        animate: false,
                        loader: loader,
                        autoScroll: true,
                        bodyStyle: 'padding: 10px'
                    });

                    var root = new Ext.tree.AsyncTreeNode({
                        id: '${tab}',
                        text: '${tab}',
                        iconCls: 'config-${configClassification}-icon',
                        allowDrag: false,
                        allowDrop: false
                    });
                    
                    configTree.setRootNode(root);
                    configTree.getSelectionModel().on('selectionchange', onConfigSelect);

                    var nestedWest = Ext.getCmp('nested-west');
                    nestedWest.add(configTree);

                    configTree.render();
                    if (!path)
                    {
                        path = 'global';
                    }

                    nestedWest.show();
                    nestedWest.setWidth(300);
                    viewport.doLayout();

                    treesInitialised = true;
                    configTree.selectConfigPath(path);
                    root.expand();
                }
            }
        }();
        
        Ext.onReady(Layout.init, Layout, true);
	</script>
</head>
<body>
#if($section == "administration")
    #adminTabs("${tab}")
#else
    #dashboardTabs("${tab}")
#end

    <div id="config-tree">
    </div>

    <div id="detail-pane" style="padding: 10px; min-height: 100%">
        #parse("/template/includes/actionerrors.vm")
    </div>
</body>
</html>
