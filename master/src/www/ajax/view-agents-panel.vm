<table class="content">
    #headingRow("agents" 7)
    <tr>
        #contentHeading("agent.name" 1)
        #contentHeading("agent.location" 1)
        #contentHeading("agent.status" 1)
#authorize("ifAllGranted=ROLE_ADMINISTRATOR")
        #contentHeading("actions" 4)
#end
    </tr>
#foreach($agent in $agents)
    <tr>
    #if($agent.isSlave())
        #set($confirmMessage = $action.getText("agent.confirm.delete", [$agent.name]))

        #dynamicLinkCell($agent.name "viewAgentStatus.action?agentId=$agent.id")
        #staticCell($agent.location)

        #if($agent.enabled)
            #if($agent.disabling)
                #contentCell("agent.disabling")
#authorize("ifAllGranted=ROLE_ADMINISTRATOR")
                #linkCell("agent.enable.$agent.name" "agent.enable" "$base/admin/enableAgent.action?agentId=$agent.id&amp;enable=ENABLED")
                #linkCell("agent.disable.$agent.name" "agent.disable.now" "$base/admin/enableAgent.action?agentId=$agent.id&amp;enable=DISABLED")
                #editCell("$base/admin/editAgent!input.action?id=$agent.id" "edit_$!webwork.htmlEncode($agent.name)")
                #deleteCell("delete_$!webwork.htmlEncode($agent.name)" "$base/admin/deleteAgent.action?id=$agent.id" $confirmMessage)
#end
            #else
                #staticCell($agent.status.prettyString)
#authorize("ifAllGranted=ROLE_ADMINISTRATOR")
                #linkCell("agent.ping.$agent.name" "agent.ping" "$base/admin/pingAgent.action?agentId=$agent.id")
                #linkCell("agent.enable.$agent.name" "agent.disable" "$base/admin/enableAgent.action?agentId=$agent.id&amp;enable=DISABLED")
                #editCell("$base/admin/editAgent!input.action?id=$agent.id" "edit_$!webwork.htmlEncode($agent.name)")
                #deleteCell("delete_$!webwork.htmlEncode($agent.name)" "$base/admin/deleteAgent.action?id=$agent.id" $confirmMessage)
#end
            #end
        #else
            #if($action.upgrading($agent))
                #set($status = "$action.getText('agent.upgrading') [$agent.upgradeState.toString().toLowerCase()]")

                #staticCell($status)
                #contentCell("empty.cell")
                #contentCell("empty.cell")
                #contentCell("empty.cell")
                #contentCell("empty.cell")
            #elseif($action.failedUpgrade($agent))
                #contentCell("agent.failed.upgrade")
                #contentCell("empty.cell")
                #linkCell("agent.enable.$agent.name" "agent.enable" "$base/admin/enableAgent.action?agentId=$agent.id&amp;enable=ENABLED")
                #editCell("$base/admin/editAgent!input.action?id=$agent.id" "edit_$!webwork.htmlEncode($agent.name)")
                #deleteCell("delete_$!webwork.htmlEncode($agent.name)" "$base/admin/deleteAgent.action?id=$agent.id" $confirmMessage)
            #else
                ## Just plain disabled
                #contentCell("agent.disabled")
#authorize("ifAllGranted=ROLE_ADMINISTRATOR")
                #contentCell("empty.cell")
                #linkCell("agent.enable.$agent.name" "agent.enable" "$base/admin/enableAgent.action?agentId=$agent.id&amp;enable=ENABLED")
                #editCell("$base/admin/editAgent!input.action?id=$agent.id" "edit_$!webwork.htmlEncode($agent.name)")
                #deleteCell("delete_$!webwork.htmlEncode($agent.name)" "$base/admin/deleteAgent.action?id=$agent.id" $confirmMessage)
#end
            #end
        #end
    #else
        #dynamicLinkCell($agent.name "viewAgentStatus.action")
        #staticCell($agent.location)
        #if($agent.disabling)
            #contentCell("agent.disabling")
        #else
            #staticCell($agent.status.prettyString)
        #end
#authorize("ifAllGranted=ROLE_ADMINISTRATOR")
        #if($agent.disabling)
            #linkCell("agent.enable.master" "agent.enable" "$base/admin/enableMaster.action?enable=true")
            #linkCell("agent.disable.master" "agent.disable.now" "$base/admin/enableMaster.action?enable=false")
        #elseif($agent.enabled)
            #contentCell("empty.cell")
            #linkCell("agent.disable.master" "agent.disable" "$base/admin/enableMaster.action?enable=false")
        #else
            #contentCell("empty.cell")
            #linkCell("agent.enable.master" "agent.enable" "$base/admin/enableMaster.action?enable=true")
        #end
        #editCell("$base/admin/editMasterAgent!input.action" "edit_$!webwork.htmlEncode($agent.name)")
        #contentCell("empty.cell")
    #end
#end
    </tr>
#end
#authorize("ifAllGranted=ROLE_ADMINISTRATOR")
    #licensed("require=canAddAgent")
        #addRow("add.agent" 7 "$base/admin/addAgent!input.action" "agent.add")
    #end
#end
</table>

