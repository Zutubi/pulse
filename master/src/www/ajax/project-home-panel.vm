<table>
    <tr>

<!-- ********** Left column ********** -->

        <td class="columns" width="100%">

            <h2 class="section top">#wwtext("name=current.build")</h2>

        #if($currentBuild)
            #showBuild($currentBuild true)
        #else
            <p>
                #wwtext("name=never.built")
            </p>
        #end

        #if($recentBuilds.size() > 0)
            <h2 class="section">#wwtext("name=recent.builds")</h2>

            <table class="content">
                #headingRow("recent.builds" 9)
                <tr>
                    #contentHeading("build.id" 1)
                    #contentHeading("build.spec" 1)
                    #contentHeading("build.status" 2)
                    #contentHeading("build.tests" 1)
                    #contentHeading("build.when" 1)
                    #contentHeading("build.elapsed" 1)
                    #contentHeading("actions" 2)
                </tr>

            #foreach($buildResult in $recentBuilds)
                <tr>
                    #set($buildResult = $latestBuilds.get($index))
                    #set($cssClass = $buildResult.state.string)

                    <td class="content-right"><a href="viewBuild.action?id=$buildResult.id">$buildResult.number</a></td>
                    #classCell($buildResult.buildSpecification)
                    #statusCell($buildResult)
                    #testResultsCell($buildResult $buildResult)
                    #dateClassCell($buildResult)
                    #classCell($buildResult.stamps.prettyElapsed)
                    #viewCell($project $buildResult)
                    #changesCell($project $buildResult)
                </tr>
            #end
            </table>
        #end

            <h2 class="section">#wwtext("name=latest.changes")</h2>

            <table class="content">
                #headingRow("latest.changes" 5)
                <tr>
                    #contentHeading("change.revision" 1)
                    #contentHeading("change.who" 1)
                    #contentHeading("change.when" 1)
                    #contentHeading("change.comment" 1)
                    #contentHeading("actions" 1)
                </tr>
        #if($latestChanges.size() > 0)
            #foreach($changelist in $latestChanges)
                #set($index = $velocityCount - 1)
                <tr>
                    #rightCell($changelist.revision)
                    #dynamicCell($changelist.user)
                    #dateCell($changelist)
                    #dynamicCell($action.trimmedString($changelist.comment, 60))
                    #linkCell("view" "viewChangelist.action?id=$changelist.id")
                </tr>
            #end
        #else
                <tr>
                    <td class="content" colspan="8">#wwtext("name=no.changes")</td>
                <tr>
        #end
            </table>

        </td>

<!-- ********** Right column ********** -->

        <td class="columns" width="400px" style="padding-left: 20px;">

            <table class="fill-content">
                #headingRow("project.status" 2)
                <tr>
                    <th class="content-row">
                        #wwtext("name=state")
                    </th>
                    <td #if($project.isPaused()) class="note" #else class="content" #end>
                        $project.state.toString().toLowerCase()&nbsp;
#acl("domainObject=project" "hasPermission=4,1")
            #if($project.isPaused())
                        <a class="unadorned" href="projectState.action?id=$project.id&amp;pause=false">
                            <img style="vertical-align: top" src="/images/control_play_blue.gif"/>
                            #wwtext("name=resume")
                        </a>
            #else
                        <a class="unadorned" href="projectState.action?id=$project.id&amp;pause=true">
                            <img src="/images/control_pause_blue.gif"/>
                            #wwtext("name=pause")
                        </a>
            #end
#end
                    </td>
                </tr>
                <tr>
                    <th class="content-row">
                        #wwtext("name=project.success.rate")
                    </th>
                    <td class="content">
                        ${percentSuccessNoErrors}% (#wwtext("name=errors.excluded"))
                    </td>
                </tr>
                <tr>
                    <th class="content-row">
                        #wwtext("name=project.statistics")
                    </th>
                    <td class="content">
                        <img class="centre" title="$successfulBuilds (${percentSuccessful}%) successful" src="/images/box-success.gif" height="10" width="$percentSuccessful"/><img class="centre" title="$failedBuilds (${percentFailed}%) failed" src="/images/box-failure.gif" height="10" width="$percentFailed"/><img class="centre" title="$errorBuilds (${percentError}%) errors" src="/images/box-error.gif" height="10" width="$percentError"/>
                        <br/>$totalBuilds builds (s: $successfulBuilds, f: $failedBuilds, e: $errorBuilds)
                    </td>
                </tr>
            </table>

            <table id="project.buildspecs" class="fill-content">
                #headingRow("project.buildspecs" 2)
    #foreach($buildSpec in $project.buildSpecifications)
                <tr>
                    #dynamicCell($buildSpec.name)
#acl("domainObject=project" "hasPermission=4,1")
                    #actionCell("buildspec.trigger" "triggerBuild.action?id=$buildSpec.id&amp;projectId=$project.id" "lightning.gif")
#end
                </tr>
    #end
            </table>

            <table class="fill-content">
                #headingRow("project.basics" 2)
                #dynamicRow("project.name" $project.name)
            #if($project.description && $project.description.length() > 0)
                <tr>
                    #contentRowHeading("project.description")
                    #wrapCell($project.description)
                </tr>
            #end
            #if($project.url && $project.url.length() > 0)
                #dynamicLinkRow("project.url" "homepage" $project.url)
            #end
#authorize("ifAllGranted=ROLE_ADMINISTRATOR")
                <tr>
                    <th class="content-row" rowspan="2">#wwtext("name=actions")</th>
                    <td class="content">
                        <a href="cloneProject!input.action?id=$project.id">
                            <img src="/images/page_copy.gif"/> #wwtext("name=project.clone")
                        </a>
                    </td>
                </tr>
                <tr>
                    <td class="content">
            #if($projectNotBuilding)
                        <a href="deleteProject!input.action?id=$project.id">
                            <img src="/images/delete.gif"/> #wwtext("name=delete.project")
                        </a>
            #else
                        #wwtext("name=project.actions.building")
            #end
#end
                    </td>
                </tr>
            </table>

        </td>
    </tr>
</table>
