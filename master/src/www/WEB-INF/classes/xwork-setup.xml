<!DOCTYPE xwork PUBLIC "-//OpenSymphony Group//XWork 1.0//EN"
        "http://www.opensymphony.com/xwork/xwork-1.1.1.dtd">
<xwork>
    <include file="webwork-default-package.xml"/>

    <package name="default" extends="webwork-default-package">
        <default-interceptor-ref name="completeStack"/>

        <action name="default" class="com.zutubi.pulse.web.ActionSupport">
            <result name="success" type="redirect">/setup/setup.action</result>
        </action>

        <action name="404" class="com.zutubi.pulse.web.FourOhFourAction">
            <result name="404" type="velocity">404.vm</result>
            <result name="starting" type="velocity">404-starting.vm</result>
        </action>

<!--
        <action name="404" class="com.zutubi.pulse.web.StartupRedirectAction">
            <result name="error" type="httpheader">
                <param name="status">404</param>
            </result>
            <result name="success" type="redirect">/startup/starting.action</result>
        </action>
-->

    </package>

    <package name="setup" namespace="/setup" extends="webwork-default-package">
        <default-interceptor-ref name="completeStack"/>

        <action name="setup" class="com.zutubi.pulse.web.setup.SetupWorkflowAction">
            <result name="data" type="redirect">/setup/setupData!input.action</result>
            <result name="setup" type="redirect">/setup/setupWizard.action</result>
            <result name="license" type="redirect">/setup/setupLicense!input.action</result>
            <result name="upgrade" type="redirect">/upgrade/preview.action</result>
            <result name="success" type="redirect">/</result>
        </action>

        <action name="setupData" class="com.zutubi.pulse.web.setup.SetupDataAction">
            <result name="input" type="velocity">/setup/configure-pulsedata.vm</result>
            <result name="success" type="redirect">/</result>
        </action>

        <action name="setupLicense" class="com.zutubi.pulse.web.setup.SetupLicenseAction">
            <result name="input" type="velocity">/setup/configure-license.vm</result>
            <result name="success" type="redirect">/</result>
        </action>

        <action name="setupWizard" class="com.zutubi.pulse.web.wizard.WizardAction">
            <interceptor-ref name="wizardStack"/>
            <param name="wizardClass">com.zutubi.pulse.web.setup.SetupWizard</param>
            <result name="admin" type="velocity">/setup/create-admin.vm</result>
            <result name="settings" type="velocity">/setup/server-settings.vm</result>
            <result name="cancel" type="redirect">/default.action</result>
            <result name="success" type="redirect">execute.action</result>
        </action>

        <action name="execute" class="com.zutubi.pulse.web.setup.SetupActionSupport">
            <result name="success" type="velocity">/system-setup.vm</result>
        </action>

    </package>


    <package name="upgrade" namespace="/upgrade" extends="webwork-default-package">
        <default-interceptor-ref name="completeStack"/>

        <action name="preview" class="com.zutubi.pulse.web.upgrade.UpgradePreviewAction">
            <result name="success" type="velocity">preview.vm</result>
        </action>

        <action name="execute" class="com.zutubi.pulse.web.upgrade.UpgradeExecuteAction">
            <interceptor-ref name="executeAndWaitStack"/>
            <result name="wait" type="velocity">status.vm</result>
            <result name="cancel" type="redirect">/setup/setup!input.action</result>
            <result name="success" type="velocity">complete.vm</result>
        </action>

        <action name="continue" class="com.zutubi.pulse.web.upgrade.PostUpgradeAction">
            <result name="success" type="redirect">/</result>
        </action>

    </package>

    <package name="startup" extends="webwork-default-package">
        <default-interceptor-ref name="completeStack"/>

        <action name="starting" class="com.zutubi.pulse.web.ActionSupport">
            <result name="success" type="velocity">system-starting.vm</result>
        </action>

    </package>

    <package name="ajax" namespace="/ajax" extends="webwork-default-package">

        <default-interceptor-ref name="ajaxStack"/>

        <action name="ls" class="com.zutubi.pulse.web.fs.LsAction">
            <result name="success" type="json">ls.xml</result>
        </action>

        <action name="mkdir" class="com.zutubi.pulse.web.fs.MkdirAction">
            <result name="success" type="json">mkdir.xml</result>
        </action>

        <action name="rmdir" class="com.zutubi.pulse.web.fs.RmdirAction">
            <result name="success" type="json">rmdir.xml</result>
        </action>

    </package>

    <package name="popups" namespace="/popups" extends="webwork-default-package">

        <default-interceptor-ref name="completeStack"/>

        <action name="browse-dirs" class="com.zutubi.pulse.web.tree.SelectDirectoryAction">
            <result name="success" type="velocity">tree/browse-dirs.vm</result>
        </action>

    </package>

</xwork>